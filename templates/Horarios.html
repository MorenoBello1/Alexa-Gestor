<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<body>
  <nav class="navbar sticky-top" style="background-color:#EC3237 ;color: #ffffff;padding: 0.5rem 1rem; height: 3rem;"  >  

    <div class="d-flex justify-content-around" style="background-color:#EC3237">
      <!--NAVEGACION -->
      <div class="p-2"> <a href="/home/" style="text-decoration: none; color: #ffffff;">Página Principal</a></div>
      <div class="p-2"> <a href="/comunidades/" style="text-decoration: none; color: #ffffff;">Comunidades</a></div>
    </div>
  </nav>
  <nav class="navbar " style="background-color:#424242 ;color: #ffffff;"  >  
      <div class="d-flex justify-content-around" >
      <img src="https://i.ibb.co/2MkzN5x/logo-ULEAM-2017-horizontal-blanco.png" style="height: 4rem;">
      </div>
  </nav>
  
      <div class="container mt-5">
        <h1>Subir Horario de Clases (PDF)</h1>
        <form id="uploadForm" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="nombreDocente" class="form-label">Nombre del Docente:</label>
                <input type="text" class="form-control" id="nombreDocente" name="nombreDocente" list="docenteList" required>
                <datalist id="docenteList">
                    <!-- Aquí se rellenarán los nombres de los docentes existentes desde la base de datos -->
                </datalist>
            </div>
            <div class="mb-3">
                <label for="pdfFile" class="form-label">Seleccionar archivo PDF:</label>
                <input type="file" class="form-control" id="pdfFile" name="pdfFile" accept="application/pdf" required>
            </div>
            <button type="submit" class="btn btn-primary">Subir</button>
        </form>
    </div>
<body>
  <script>
      // Rellenar la lista de selección con los nombres existentes desde la base de datos
      fetch('/api/docentes')
          .then(response => response.json())
          .then(data => {
              const datalist = document.getElementById('docenteList');
              data.docentes.forEach(docente => {
                  const option = document.createElement('option');
                  option.value = docente.nombre;
                  datalist.appendChild(option);
              });
          })
          .catch(error => {
              console.error('Error:', error);
              alert('Ocurrió un error al obtener la lista de docentes.');
          });

      document.getElementById('uploadForm').addEventListener('submit', function(event) {
          event.preventDefault(); // Evita que se envíe el formulario de manera tradicional

          var formData = new FormData(this);

          fetch('/upload/pdf', {
              method: 'POST',
              body: formData
          })
          .then(response => response.json())
          .then(data => {
              alert(data.message); // Muestra el mensaje de respuesta del servidor
          })
          .catch(error => {
              console.error('Error:', error);
              alert('Ocurrió un error al subir el archivo.');
          });
      });
  </script>
</html>